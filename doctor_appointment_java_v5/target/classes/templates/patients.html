<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Patients - Doctor Appointment</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <script defer th:src="@{/js/main.js}"></script>
</head>
<body class="dark-body">
    <div class="app-container fade-in parallax-bg">
        <nav class="top-nav">
            <div class="brand" data-en="ðŸ©º Doctor Appointment" data-hi="ðŸ©º à¤¡à¥‰à¤•à¥à¤Ÿà¤° à¤…à¤ªà¥‰à¤‡à¤‚à¤Ÿà¤®à¥‡à¤‚à¤Ÿ">
                ðŸ©º Doctor Appointment
            </div>
            <div class="nav-links">
                <a th:href="@{/dashboard}" data-en="Dashboard" data-hi="à¤¡à¥ˆà¤¶à¤¬à¥‹à¤°à¥à¤¡">Dashboard</a>
                <a th:href="@{/doctors}" data-en="Doctors" data-hi="à¤¡à¥‰à¤•à¥à¤Ÿà¤°">Doctors</a>
                <a th:href="@{/patients}" class="active" data-en="Patients" data-hi="à¤ªà¥‡à¤¶à¥‡à¤‚à¤Ÿ">Patients</a>
                <a th:href="@{/appointments}" data-en="Appointments" data-hi="à¤…à¤ªà¥‰à¤‡à¤‚à¤Ÿà¤®à¥‡à¤‚à¤Ÿ">Appointments</a>
                <a th:href="@{/logout}" data-en="Logout" data-hi="à°²à°¾à°—à±â€Œà°…à°µà±à°Ÿà±">Logout</a>
            </div>
            <button type="button" class="lang-toggle" id="langToggle" data-lang="en">
                EN / HI
            </button>
        </nav>
        <main class="main-content">
            <div class="page-header">
                <h1 class="page-title" data-en="Patients" data-hi="à¤ªà¥‡à¤¶à¥‡à¤‚à¤Ÿ">Patients</h1>
            </div>

            <div class="grid-2">
                <div class="card slide-up glow-card">
                    <h3 data-en="Add Patient" data-hi="à¤ªà¥‡à¤¶à¥‡à¤‚à¤Ÿ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚">Add Patient</h3>
                    <form method="post" th:action="@{/patients}">
                        <div class="form-group">
                            <label data-en="Name" data-hi="à¤¨à¤¾à¤®">Name</label>
                            <input type="text" name="name" required>
                        </div>
                        <div class="form-group">
                            <label data-en="Phone" data-hi="à¤«à¥‹à¤¨">Phone</label>
                            <input type="text" name="phone" required>
                        </div>
                        <div class="form-group">
                            <label data-en="Gender" data-hi="à¤²à¤¿à¤‚à¤—">Gender</label>
                            <select name="gender" required>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <button type="submit" class="btn-primary hover-lift" data-en="Save" data-hi="à¤¸à¥‡à¤µ">Save</button>
                    </form>
                </div>

                <div class="card slide-up glow-card" style="animation-delay:0.1s">
                    <h3 data-en="All Patients" data-hi="à¤¸à¤­à¥€ à¤ªà¥‡à¤¶à¥‡à¤‚à¤Ÿ">All Patients</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th data-en="Name" data-hi="à¤¨à¤¾à¤®">Name</th>
                                <th data-en="Phone" data-hi="à¤«à¥‹à¤¨">Phone</th>
                                <th data-en="Gender" data-hi="à¤²à¤¿à¤‚à¤—">Gender</th>
                                <th data-en="Face" data-hi="à¤šà¥‡à¤¹à¤°à¤¾">Face</th>
                                <th data-en="Actions" data-hi="à¤•à¥à¤°à¤¿à¤¯à¤¾">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="p : ${patients}">
                                <td th:text="${p.id}">1</td>
                                <td th:text="${p.name}">Name</td>
                                <td th:text="${p.phone}">Phone</td>
                                <td th:text="${p.gender}">Gender</td>
                                <td>
                                    <img th:if="${p.faceImageBase64 != null}" th:src="'data:image/png;base64,' + ${p.faceImageBase64}" class="face-avatar" alt="face">
                                    <span class="muted small" th:if="${p.faceImageBase64 == null}" data-en="No image" data-hi="à¤•à¥‹à¤ˆ à¤‡à¤®à¥‡à¤œ à¤¨à¤¹à¥€à¤‚">No image</span>
                                </td>
                                <td>
                                    <button type="button"
                                            class="btn-small hover-lift"
                                            th:attr="data-patient-id=${p.id}"
                                            data-en="Capture Face" data-hi="à¤šà¥‡à¤¹à¤°à¤¾ à¤•à¥ˆà¤ªà¥à¤šà¤° à¤•à¤°à¥‡à¤‚"
                                            onclick="openFaceCaptureModal(this)">
                                        Capture Face
                                    </button>
                                    <form th:action="@{'/patients/delete/' + ${p.id}}" method="post" style="display:inline">
                                        <button class="btn-small danger hover-lift" data-en="Delete" data-hi="à¤¹à¤Ÿà¤¾à¤à¤">Delete</button>
                                    </form>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Face capture modal -->
            <div id="faceCaptureModal" class="face-modal hidden">
                <div class="face-modal-content card glow-card">
                    <h3 data-en="Face Capture" data-hi="à¤šà¥‡à¤¹à¤°à¤¾ à¤•à¥ˆà¤ªà¥à¤šà¤°">Face Capture</h3>
                    <p class="muted small" data-en="Align your face in the frame and click Capture."
                       data-hi="à¤…à¤ªà¤¨à¤¾ à¤šà¥‡à¤¹à¤°à¤¾ à¤«à¥à¤°à¥‡à¤® à¤®à¥‡à¤‚ à¤°à¤–à¥‡à¤‚ à¤”à¤° à¤•à¥ˆà¤ªà¥à¤šà¤° à¤ªà¤° à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚à¥¤">
                       Align your face in the frame and click Capture.
                    </p>
                    <div class="face-video-row">
                        <video id="faceVideo" autoplay playsinline></video>
                        <canvas id="faceCanvas" class="hidden"></canvas>
                    </div>
                    <div class="face-actions">
                        <button type="button" class="btn-small hover-lift" onclick="captureFaceFrame()" data-en="Capture" data-hi="à¤•à¥ˆà¤ªà¥à¤šà¤°">Capture</button>
                        <button type="button" class="btn-small hover-lift" onclick="closeFaceCaptureModal()" data-en="Close" data-hi="à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚">Close</button>
                    </div>
                    <form id="faceUploadForm" method="post">
                        <input type="hidden" name="imageData" id="faceImageData">
                    </form>
                </div>
            </div>

        
                <!-- Edit patient modal -->
                <div id="editPatientModal" class="face-modal hidden">
                    <div class="face-modal-content card glow-card">
                        <h3 data-en="Edit Patient" data-hi="à¤ªà¥‡à¤¶à¥‡à¤‚à¤Ÿ à¤¸à¤‚à¤ªà¤¾à¤¦à¤¿à¤¤ à¤•à¤°à¥‡à¤‚">Edit Patient</h3>
                        <form id="editPatientForm" method="post">
                            <div class="form-group">
                                <label data-en="Name" data-hi="à¤¨à¤¾à¤®">Name</label>
                                <input id="editName" name="name" type="text" required>
                            </div>
                            <div class="form-group">
                                <label data-en="Phone" data-hi="à¤«à¥‹à¤¨">Phone</label>
                                <input id="editPhone" name="phone" type="text" required>
                            </div>
                            <div class="form-group">
                                <label data-en="Gender" data-hi="à¤²à¤¿à¤‚à¤—">Gender</label>
                                <select id="editGender" name="gender">
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="face-actions">
                                <button class="btn-primary hover-lift" type="submit" data-en="Update" data-hi="à¤…à¤ªà¤¡à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚">
                                    Update
                                </button>
                                <button type="button" class="btn-small hover-lift" onclick="closeEditPatientModal()" data-en="Close" data-hi="à¤¬à¤‚à¤¦ à¤•à¤°à¥‡à¤‚">
                                    Close
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

</main>
    </div>
</body>
</html>
